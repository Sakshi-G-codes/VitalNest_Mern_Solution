<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VitalNest</title>
    <link rel = "stylesheet" href = "/static/style.css">
</head>
<body  style="background-color:#ebf9fa;">
    <h1 class="admin_user_approval_card_heading">Vital Nest Admin Dashboard - <%= admin_id %></h1>
    <hr>
    <div>
        <h2 style="text-align: center;">Registration Approval Data</h2>
        <table border="1.5" cellpadding="15" cellspacing="0" style="margin: auto; background-color: rgb(250, 240, 255);">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Aadhar</th>
                    <th>Mobile Number</th>
                    <th>User Type</th>
                    <th>Request timestamp</th>
                    <th>Take Action</th>
                </tr>
            </thead>
            <tbody style="background-color: white;">
                <% for(record of approval_data) { %>
                <tr>
                    <td><%= record.name %></td>
                    <td><%= record.aadhar %></td>
                    <td><%= record.mobile %></td>
                    <td><%= record.user_type %></td>
                    <td><%= record.request_timestamp %></td>
                    <td>
                        <form action="/approveUser" method="post">
                            <input type="hidden" name="name" value="<%= record.name %>">
                            <input type="hidden" name="aadhar" value="<%= record.aadhar %>">
                            <input type="hidden" name="mobile" value="<%= record.mobile %>">
                            <input type="hidden" name="type" value="<%= record.user_type %>">
                            <input type="hidden" name="passwd" value="<%= record.passwd %>">
                            <button class="admin_user_approval_card_accept_button_design" type="submit" name="action" value="approve">Approve</button>
                            <button class="admin_user_approval_card_reject_button_design" type="submit" name="action" value="reject">Reject</button>
                        </form>
                    </td>
                </tr>
                <% } %>
            </tbody>
        </table>
    </div>
    <hr>
        <div >
        <h2 style="text-align: center;">Search for Patient Records log Data</h2>
        <div class="admin_patient_record_card_design">
        <form action="/patientRecordsLogData" method="post">
            <label for="aadhar">Patient ID (Aadhar):</label><br>
            <input type="text" id="p_id" name="aadhar" pattern="\d{12}" maxlength="12" minlength="12" required><br><br>
            
            <input class="admin_patient_record_button_design" type="submit" value="Submit">
        </form>
        </div>
    </div>
    <hr>
    <div>
        <h2 style="text-align: center;">Users data</h2>
        <table border="1.5" cellpadding="15" cellspacing="0" style="margin: auto; background-color: rgb(250, 240, 255); ">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Aadhar</th>
                    <th>Mobile Number</th>
                    <th>User Type</th>
                </tr>
            </thead>
            <tbody style="background-color: white;">
                <% for(user of users) { %>
                <tr>
                    <td><%= user.name %></td>
                    <td><%= user.aadhar %></td>
                    <td><%= user.mobile %></td>
                    <td><%= user.user_type %></td>
                </tr>
                <% } %>
            </tbody>
        </table>
    </div>
    <hr>
    <div>
        <h2 style="text-align: center;">Hospital Managers in Charge</h2>
        <table border="1.5" cellpadding="15" cellspacing="0" style="margin: auto; background-color: rgb(250, 240, 255);">
            <thead>
                <tr>
                    <th>HSP ID</th>
                    <th>Manager ID</th>
                    <th>Phone Number</th>
                </tr>
            </thead>
            <tbody style="background-color: white;">
                <% hsp_data.forEach(record => { %>
                <tr>
                    <td><%= record.hsp_id %></td>
                    <td><%= record.manager[0].aadhar %></td>
                    <td><%= record.manager[0].mobile %></td>
                </tr>
                <% }) %>
            </tbody>
        </table>
    </div>
    <hr>
    <div>
        <h2 style="text-align: center;">Industry Managers in Charge</h2>
        <table border="1.5" cellpadding="15" cellspacing="0" style="margin: auto; background-color: rgb(250, 240, 255);">
            <thead>
                <tr>
                    <th>IND ID</th>
                    <th>Manager ID</th>
                    <th>Phone Number</th>
                </tr>
            </thead>
            <tbody style="background-color: white;">
                <% ind_data.forEach(record => { %>
                <tr>
                    <td><%= record.ind_id %></td>
                    <td><%= record.manager[0] %></td>
                    <td><%= record.manager[0] %></td>
                </tr>
                <% }) %>
            </tbody>
        </table>
    </div>
    <hr>
    <div>
        <h2 style="text-align: center;">Blood Donation Camp Requests</h2>
        <table border="1.5" cellpadding="15" cellspacing="0" style="margin: auto; background-color: rgb(250, 240, 255);">
            <thead>
                <tr>
                    <th>Request ID</th>
                    <th>NGO ID</th>
                    <th>Request Details</th>
                    <th>Status</th>
                    <th>Request Timestamp</th>
                    <th>Take Action</th>
                </tr>
            </thead>
            <tbody style="background-color: white;">
                <% pending_blood_requests.forEach(request => { %>
                <tr>
                    <td><%= request._id %></td>
                    <td><%= request.ngo_id %></td>
                    <td><%= request.request_details %></td>
                    <td><%= request.status %></td>
                    <td><%= request.request_timestamp %></td>
                    <td>
                        <% if (request.status === 'pending') { %>
                        <form action="/approveBloodDonationRequest" method="post">
                            <input type="hidden" name="id" value="<%= request._id %>">
                            <button class="admin_user_approval_card_accept_button_design" type="submit" name="action" value="approve">Approve</button>
                            <button class="admin_user_approval_card_reject_button_design" type="submit" name="action" value="reject">Reject</button>
                        </form>
                        <% } else { %>
                        <%= request.status %>
                        <% } %>
                    </td>
                </tr>
                <% }) %>
            </tbody>
        </table>
    </div>
    <hr>
    <div>
        <h2 style="text-align: center;">Approved Blood Donation Camp Requests</h2>
        <table border="1.5" cellpadding="15" cellspacing="0" style="margin: auto; background-color: rgb(250, 240, 255);">
            <thead>
                <tr>
                    <th>Request ID</th>
                    <th>NGO ID</th>
                    <th>Request Details</th>
                    <th>Status</th>
                    <th>Request Timestamp</th>
                    <th>Donation Data</th>
                </tr>
            </thead>
            <tbody style="background-color: white;">
                <% approved_blood_requests.forEach(request => { %>
                <tr>
                    <td><%= request._id %></td>
                    <td><%= request.ngo_id %></td>
                    <td><%= request.request_details %></td>
                    <td><%= request.status %></td>
                    <td><%= request.request_timestamp %></td>
                    <td>
                        <form action="/viewBloodDonationData" method="post">
                            <input type="hidden" name="request_id" value="<%= request._id %>">
                            <button type="submit">View Data</button>
                        </form>
                    </td>
                </tr>
                <% }) %>
            </tbody>
        </table>
    </div>
    <hr>
    <div>
        <h2 style="text-align: center;">Blood Units Available</h2>
        <table border="1.5" cellpadding="15" cellspacing="0" style="margin: auto; background-color: rgb(250, 240, 255);">
            <thead>
                <tr>
                    <th>Blood Group</th>
                    <th>Units Available</th>
                </tr>
            </thead>
            <tbody style="background-color: white;">
                <% blood_units.forEach(unit => { %>
                <tr>
                    <td><%= unit.blood_group %></td>
                    <td><%= unit.units %></td>
                </tr>
                <% }) %>
            </tbody>
        </table>
    </div>
    <hr>
    <div style="text-align: center;">
        <h2>Log Data</h2>

        <form action="/LogData" method="post">
            <input type="hidden" name="aadhar" value="<%= admin_id %>">
            <button class="view_log_data_button">View Log Data</button>
        </form>
    </div>
    <hr>
    <div>
        <h2 style="text-align: center;">View Hospital Performance Metrics</h2>
        <form action="/hospitalMetrics" method="post">
            <label for="hsp_id">Select Hospital ID:</label>
            <select name="hsp_id" id="hsp_id" required>
                <% hsp_data.forEach(hsp => { %>
                <option value="<%= hsp.hsp_id %>"><%= hsp.hsp_id %></option>
                <% }) %>
            </select><br><br>
            <label for="period_type">Select Period Type:</label>
            <select name="period_type" id="period_type" required>
                <option value="day">Day</option>
                <option value="month">Month</option>
                <option value="year">Year</option>
            </select><br><br>
            <div id="year_div" style="display:none;">
                <label for="year">Year:</label>
                <select name="year" id="year">
                    <% for (let y = 2020; y <= 2030; y++) { %>
                    <option value="<%= y %>"><%= y %></option>
                    <% } %>
                </select><br><br>
            </div>
            <div id="month_div" style="display:none;">
                <label for="month">Month:</label>
                <select name="month" id="month">
                    <option value="01">January</option>
                    <option value="02">February</option>
                    <option value="03">March</option>
                    <option value="04">April</option>
                    <option value="05">May</option>
                    <option value="06">June</option>
                    <option value="07">July</option>
                    <option value="08">August</option>
                    <option value="09">September</option>
                    <option value="10">October</option>
                    <option value="11">November</option>
                    <option value="12">December</option>
                </select><br><br>
            </div>
            <div id="day_div" style="display:none;">
                <label for="day">Date:</label>
                <input type="date" name="day" id="day"><br><br>
            </div>
            <script>
                document.getElementById('period_type').addEventListener('change', function() {
                    var type = this.value;
                    document.getElementById('year_div').style.display = (type === 'year' || type === 'month') ? 'block' : 'none';
                    document.getElementById('month_div').style.display = (type === 'month') ? 'block' : 'none';
                    document.getElementById('day_div').style.display = (type === 'day') ? 'block' : 'none';
                    document.getElementById('year').required = (type === 'year' || type === 'month');
                    document.getElementById('month').required = (type === 'month');
                    document.getElementById('day').required = (type === 'day');
                });
            </script>
            <button type="submit">View Metrics</button>
        </form>
    </div>

</body>
</html>
